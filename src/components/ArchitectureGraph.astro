---
import { 
  Globe, 
  Lock, 
  ArrowDownCircle, 
  Activity, 
  Layers, 
  Network, 
  FileText, 
  Database,
  Terminal,
  Cpu,
  Box
} from 'lucide-react';
---
<div class="w-full py-12 px-4 bg-surfacedark:bg-surface/50 rounded-3xl border border-border-subtle my-16 overflow-x-auto">
  <div class="min-w-[800px] flex flex-col items-center gap-12">
    {/* Control Plane */}
    <div class="w-full max-w-4xl p-8 rounded-2xl border-2 border-dashed border-brand-blue/30 bg-surface relative">
      <div class="absolute -top-4 left-6 px-3 py-1 bg-brand-blue text-white dark:text-slate-950 text-[10px] font-bold uppercase rounded">SaaS Control Plane</div>
      <div class="grid grid-cols-4 gap-4">
        {[
          { icon: Globe, name: "API Gateway", sub: "HTTPS/JSON" },
          { icon: Lock, name: "Auth Service", sub: "API Keys" },
          { icon: ArrowDownCircle, name: "Enrollment", sub: "Tokens" },
          { icon: Activity, name: "Ingest", sub: "Heartbeats" },
          { icon: Layers, name: "Plan Service", sub: "Idempotency" },
          { icon: Network, name: "NetBird", sub: "Mesh Adapter" },
          { icon: FileText, name: "Audit", sub: "Logs" },
          { icon: Database, name: "PostgreSQL", sub: "Sites/VMs" }
        ].map((item) => (
          <div class="p-4 rounded-xl border border-border-subtle bg-surfacedark:bg-surfaceflex flex-col items-center text-center gap-2">
            <item.icon size={20} className="text-brand-blue" />
            <div class="text-xs font-bold text-content-primary leading-tight">{item.name}</div>
            <div class="text-[10px] text-content-muted font-mono">{item.sub}</div>
          </div>
        ))}
      </div>
    </div>

    {/* Connection */}
    <div class="flex flex-col items-center gap-2">
      <div class="w-0.5 h-12 bg-gradient-to-b from-brand-blue to-accent animate-pulse"></div>
      <div class="px-4 py-1 rounded-full border border-brand-blue/20 bg-brand-blue/5 text-[10px] font-mono text-brand-blue uppercase tracking-widest">
        mTLS Agent Channel
      </div>
      <div class="w-0.5 h-12 bg-gradient-to-t from-accent to-brand-blue animate-pulse"></div>
    </div>

    {/* Edge Data-Plane */}
    <div class="w-full max-w-4xl p-8 rounded-2xl border-2 border-dashed border-accent/30 bg-surface relative">
      <div class="absolute -top-4 left-6 px-3 py-1 bg-accent text-content-primary text-[10px] font-bold uppercase rounded">Edge Data-Plane (Per Site)</div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {/* Agent Box */}
        <div class="p-6 rounded-xl border border-border-subtle bg-surfacedark:bg-surfaceborder-l-4 border-l-brand-blue">
          <h4 class="text-sm font-bold mb-4 flex items-center gap-2 text-content-primary">
            <Terminal size={16} className="text-brand-blue" /> nkudo-edge Agent
          </h4>
          <div class="grid grid-cols-2 gap-2 text-[10px]">
            {["Enroll Client", "mTLS Client", "Host Facts", "Plan Executor", "State Store (JSON)", "NetBird Module"].map(s => (
              <div class="px-2 py-1.5 bg-surface0 rounded border border-border-subtleborder-border-subtle text-content-secondary font-medium">{s}</div>
            ))}
          </div>
        </div>
        {/* Hypervisor Box */}
        <div class="p-6 rounded-xl border border-border-subtle bg-surfacedark:bg-surfaceborder-l-4 border-l-accent flex flex-col justify-center">
          <h4 class="text-sm font-bold mb-4 flex items-center gap-2 text-content-primary">
            <Cpu size={16} className="text-accent" /> Cloud Hypervisor
          </h4>
          <div class="space-y-4">
            <div class="flex gap-2">
              {[1, 2, 3].map(() => (
                <div class="flex-1 h-12 border border-accent/20 bg-accent/5 rounded-lg flex items-center justify-center relative overflow-hidden group">
                  <Box size={20} className="text-accent/50" />
                  <div class="absolute bottom-0 left-0 h-1 bg-accent w-full scale-x-0 group-hover:scale-x-100 transition-transform origin-left"></div>
                </div>
              ))}
            </div>
            <div class="text-[10px] text-content-secondary font-mono text-center">RUST-BASED VMM EXECUTION</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
